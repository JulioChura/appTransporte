<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Checkout Pro</title>
    <!-- Incluir el SDK de Mercado Pago -->
    <script src="https://sdk.mercadopago.com/js/v2"></script>
    <link href="https://fonts.googleapis.com/css2?family=Roboto+Mono&display=swap" rel="stylesheet">
</head>
<body>
    <h1>Checkout Pro</h1>
    <!-- contenedor para el botón de pago -->
    <div id="wallet_container"></div>

    <script>
        // se inicializa Mercado pago con la clave pública
        //const mp = new MercadoPago('TEST-5026173b-cdea-40a4-aae1-0b5b46847632'); 
        const mp = new MercadoPago('APP_USR-db370930-9f78-4e51-8862-eb6c8634b1ad'); 

        let precio = 5
        let ruta = "arequipa-tacna"
        // funcion para crear el botón de pago cuando el DOM está completamente cargado
        document.addEventListener('DOMContentLoaded', function() {
            // Obtén el ID de la preferencia del backend
            const url = `http://localhost:8000/api/create_preference/${precio}/${ruta}/${1}/${2}/`;

            fetch(url)  // aqui va la ruta definida en el backend
                .then(response => response.json())
                .then(preference => {
                    // inicializar el botón de pago
                    mp.bricks().create("wallet", "wallet_container", {
                        initialization: {
                            preferenceId: preference.id,  // Usa el ID de la preferencia
                        },
                        customization: {
                            texts: {
                                valueProp: 'smart_option',
                            },
                        },
                    });
                })
                .catch(error => console.error('Error:', error));
        });
    </script>
</body>
</html>
